# import libraries
from faker import Faker
import pandas as pd
import numpy as np

fake = Faker()

# Set random seed for reproducibility
np.random.seed(0)

# Generate fake sales data with seasonality and increasing trend
start_date = pd.to_datetime('2019-01-01')
end_date = pd.to_datetime('2023-06-30')
dates = pd.date_range(start=start_date, end=end_date, freq='D')

# Generate sales values with seasonality and increasing trend
seasonality = np.array([0, 0, 0, 0.5, 1, 1, 1, 1, 0.5, 0, 0, 0]) * 27  # Higher sales during May to August
trend = np.linspace(0, 1, len(dates))
starting_sales = 30
sales = trend * 42 + starting_sales + np.tile(seasonality, len(dates) // len(seasonality) + 1)[:len(dates)]

# Introduce random stockouts
num_stockouts = 80  # Number of stockout periods
stockout_indices = np.random.choice(len(dates), num_stockouts, replace=False)
sales[stockout_indices] = 0

# Create a DataFrame with generated data
df = pd.DataFrame({'Date': dates, 'Sales': sales, 'Customer Name': [fake.name() for _ in range(len(dates))]})

# Display the DataFrame
print(df.head())

# Get the data to excel
df.to_excel('fake_data_m.xlsx', index=False)
